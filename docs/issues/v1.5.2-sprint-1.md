# v1.5.2 Sprint 1: C Groups Example Implementation

**Labels:** enhancement, v1.5.2, sprint-1

## Overview

Create comprehensive NetCDF-4 groups example in C, demonstrating hierarchical group structures, nested groups, dimension visibility, and new integer types. Integrate into existing build systems.

## Tasks

### C Example Program (groups.c)

#### File Creation
- [ ] Create `examples/netcdf-4/groups.c`
- [ ] Add comprehensive Doxygen documentation header
- [ ] Include learning objectives, key concepts, and prerequisites

#### Group Structure Implementation
- [ ] Create root group (implicit)
- [ ] Create SubGroup1 using `nc_def_grp(ncid, "SubGroup1", &grp1_id)`
- [ ] Create SubGroup2 using `nc_def_grp(ncid, "SubGroup2", &grp2_id)`
- [ ] Create NestedGroup under SubGroup2 using `nc_def_grp(grp2_id, "NestedGroup", &nested_id)`

#### Dimension Definitions
- [ ] Define dimension `x=3` at root level
- [ ] Define dimension `y=4` at root level
- [ ] Define dimension `z=2` in NestedGroup
- [ ] Verify root dimensions accessible in all groups using `nc_inq_dimid()`

#### Variable Definitions (all 5 new types)
- [ ] Root group: Define NC_UBYTE variable `ubyte_var` (2D: x, y)
- [ ] SubGroup1: Define NC_USHORT variable `ushort_var` (2D: x, y)
- [ ] SubGroup2: Define NC_UINT variable `uint_var` (2D: x, y)
- [ ] NestedGroup: Define NC_INT64 variable `int64_var` (2D: x, y)
- [ ] NestedGroup: Define NC_UINT64 variable `uint64_var` (3D: x, y, z)

#### Data Operations
- [ ] Write minimal test data (3x4 arrays with sequential values: 1,2,3,...)
- [ ] For 3D variable: write 3x4x2 array
- [ ] Close file after writing

#### Validation Phase
- [ ] Reopen file in read mode
- [ ] Query and validate number of groups using `nc_inq_grps()`
- [ ] Query and validate group names using `nc_inq_grpname()`
- [ ] Query and validate dimensions in each group
- [ ] Explicitly test dimension visibility with `nc_inq_dimid()` in nested groups
- [ ] Query and validate all variable metadata (name, type, dimensions)
- [ ] Read and print all variable data
- [ ] Verify data values match what was written

#### Error Handling
- [ ] Check return codes for all NetCDF API calls
- [ ] Print descriptive error messages on failure
- [ ] Return non-zero exit code on any error

### CMake Build Integration

#### examples/netcdf-4/CMakeLists.txt
- [ ] Add groups.c to list of example programs
- [ ] Create executable: `add_executable(groups groups.c)`
- [ ] Link against NetCDF-C: `target_link_libraries(groups PRIVATE NetCDF::NetCDF)`
- [ ] Register as test: `add_test(NAME groups COMMAND groups)`

### Autotools Build Integration

#### examples/netcdf-4/Makefile.am
- [ ] Add groups.c to TESTS variable
- [ ] Add groups to check_PROGRAMS
- [ ] Set groups_SOURCES = groups.c
- [ ] Set groups_LDADD = $(NETCDF_LIBS)

### Testing

#### Test Execution
- [ ] Verify groups.c runs without errors (exit code 0)
- [ ] Verify NetCDF file is created
- [ ] Manual inspection of ncdump output to verify structure

#### Build System Testing
- [ ] Test CMake build with BUILD_EXAMPLES=ON
- [ ] Test CMake build with BUILD_EXAMPLES=OFF
- [ ] Test Autotools build with --enable-examples
- [ ] Test Autotools build with --disable-examples

## Implementation Notes

### Group Hierarchy Navigation
```c
// Get group IDs for navigation
int root_id, grp1_id, grp2_id, nested_id;
nc_inq_grp_ncid(ncid, "SubGroup1", &grp1_id);
nc_inq_grp_ncid(ncid, "SubGroup2", &grp2_id);
nc_inq_grp_ncid(grp2_id, "NestedGroup", &nested_id);
```

### Dimension Visibility Testing
```c
// Verify root dimensions are visible in nested group
int x_dimid, y_dimid;
nc_inq_dimid(nested_id, "x", &x_dimid);  // Should succeed
nc_inq_dimid(nested_id, "y", &y_dimid);  // Should succeed
```

### New Integer Types
```c
// All 5 new types demonstrated
NC_UBYTE   // unsigned 8-bit integer (0 to 255)
NC_USHORT  // unsigned 16-bit integer (0 to 65535)
NC_UINT    // unsigned 32-bit integer (0 to 4294967295)
NC_INT64   // signed 64-bit integer
NC_UINT64  // unsigned 64-bit integer
```

## Definition of Done

- [ ] groups.c created and documented
- [ ] Example compiles in CMake build
- [ ] Example compiles in Autotools build
- [ ] Example runs as test in both build systems
- [ ] Example passes (exit code 0)
- [ ] NetCDF file created with correct group structure
- [ ] Manual ncdump verification shows expected structure
- [ ] CI passes with new example

## References

- Existing examples: `examples/netcdf-4/simple_nc4.c`, `examples/netcdf-4/multi_unlimited.c`
- NetCDF-4 Groups API: https://docs.unidata.ucar.edu/netcdf-c/current/group_8c.html
- NetCDF-4 Types: https://docs.unidata.ucar.edu/netcdf-c/current/data_type.html
- v1.5.1 Sprint 1 for build integration patterns
